getwd
getwd()
ff_fctor_monthly <- read.csv2(file = "F-F_Researh_Data_Factors.csv", skip = 3)
ff_fctor_monthly <- read.csv2(file = "F-F_Researh_Data_Factors.CSV", skip = 3)
ff_fctor_monthly <- read.csv2(file = "F-F_Research_Data_Factors.CSV", skip = 3)
rm(ff_fctor_monthly, envir = as.environment(".GlobalEnv"))
ff_fctor_monthly <- read.csv2(file = "F-F_Research_Data_Factors.CSV", skip = 3)
rm(list = ls())
ff_factor_monthly <- read.csv2(file = "F-F_Research_Data_Factors.CSV", skip = 3)
ff_factor_monthly
rm(list = ls())
ff_factor_monthly <- read.csv2(file = "F-F_Research_Data_Factors.CSV", skip = 3, header = TRUE, nrow = 1095)
ff_factor_monthly <- read.csv2(file = "F-F_Research_Data_Factors.CSV", skip = 4, header = TRUE, nrow = 1094)
ff_factor_monthly <- read.csv2(file = "F-F_Research_Data_Factors.CSV", skip = 4, header = TRUE, nrow = 1093)
ff_factor_monthly <- read.csv2(file = "F-F_Research_Data_Factors.CSV", skip = 3, header = TRUE, nrow = 1093)
ff_factor_monthly <- read.csv2(file = "F-F_Research_Data_Factors.CSV", skip = 3, header = TRUE, nrow = 1094)
head(ff_factor_monthly)
colnames(ff_factor_monthly)
col_name<-unlist(colnames(ff_factor_monthly),split=".")
col_name<-unlist(stringsplit(colnames(ff_factor_monthly),split="."))
col_name<-unlist(strsplit(colnames(ff_factor_monthly),split="."))
rm(col_name, envir = as.environment(".GlobalEnv"))
col_name<-unlist(strsplit(colnames(ff_factor_monthly),split=". "))
col_name
col_name<-unlist(strsplit(colnames(ff_factor_monthly),split="."))
?strsplit
col_name<-unlist(strsplit(colnames(ff_factor_monthly),split="\\."))
col_name["X"]<-"Date"
col_name<-unlist(strsplit(colnames(ff_factor_monthly),split="\\."))
col_name[1]<-"Date"
ff_factor_anual <- read.csv2(file = "F-F_Research_Data_Factors.CSV", skip = 1101, header = TRUE, nrow = 90)
rm(list = ls())
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
col_name[1]
colnames
col_name
length(ff_factor_monthly)
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
col_name <- unlist(strsplit(colnames(ff_factor_monthly), split = "\\."))
ff_factor_monthly <- read.csv2(file = "F-F_Research_Data_Factors.CSV", skip = 4, header = TRUE, nrow = 1094)
col_name <- unlist(strsplit(colnames(ff_factor_monthly), split = "\\."))
ff_factor_monthly <- read.csv2(file = "F-F_Research_Data_Factors.CSV", skip = 4, header = TRUE, nrow = 1094)
col_name <- unlist(strsplit(colnames(ff_factor_monthly), split = "\\."))
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
ff_factor_monthly <- read.csv2(file = "F-F_Research_Data_Factors.CSV", skip = 3, header = TRUE, nrow = 1094)
col_name <- unlist(strsplit(colnames(ff_factor_monthly), split = "\\."))
ff_factor_monthly <- read.csv2(file = "F-F_Research_Data_Factors.CSV", skip = 3, header = TRUE, nrow = 1094)
col_name <- unlist(strsplit(colnames(ff_factor_monthly), split = "\."))
col_name <- unlist(strsplit(colnames(ff_factor_monthly), split = "."))
ff_factor_monthly <- read.csv2(file = "F-F_Research_Data_Factors.CSV", skip = 3, header = TRUE, nrow = 1094)
col_name <- unlist(strsplit(colnames(ff_factor_monthly), split = "\\.", fixed = TURE))
ff_factor_monthly <- read.csv2(file = "F-F_Research_Data_Factors.CSV", skip = 3, header = TRUE, nrow = 1094)
col_name <- unlist(strsplit(colnames(ff_factor_monthly), split = "\\.", fixed = TRUE))
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rm(list = ls())
ind_port <- read.csv(file = "12_industry_portfolios.CSV")
rm(list = ls())
ind_port <- read.csv(file = "12_industry_portfolios.CSV")
rm(ind_port, envir = as.environment(".GlobalEnv"))
colname_ind <- read.csv(file = "12_industry_portfolios.CSV", skip = 11, header = FALSE)
colname_ind <- read.csv(file = "12_industry_portfolios.CSV", skip = 11, nrow = 1, header = FALSE)
ind_port <- read.csv(file = "12_industry_portfolios.CSV", skip = 12, header = FALSE)
ind_port <- read.csv(file = "12_industry_portfolios.CSV", skip = 11, header = TRUE)
ind_port <- read.csv(file = "12_industry_portfolios.CSV", skip = 11, nrow = 4754, header = TRUE)
ind_port <- read.csv(file = "12_industry_portfolios.CSV", skip = 11, nrow = 1094, header = TRUE)
ff_factor_monthly <- read.csv(file = "F-F_Research_Data_Factors.CSV", skip = 4, header = FALSE, nrow = 1094)
ff_factor_monthly <- read.csv(file = "F-F_Research_Data_Factors.CSV", skip = 3, header = TRUE, nrow = 1094)
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
colnames(ff_factor_monthly)
colnames(ff_factor_monthly)[1]
colnames(ff_factor_monthly)["X"]
colnames(ff_factor_monthly)["X",]
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
?as.Date
class(ff_factor_monthly[,"Date"])
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
class(ff_factor_monthly[,"Date"])
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
as.Date(as.character(196001),format="Y%%m")
as.Date(196001,format="Y%%m")
as.Date("196001",format="Y%%m")
as.Date("196001",format="%Y%m")
?solve
dim(ff_factor_monthly)
for (i in 2:ncol(ind_port_monthly)) { 	avg_return <- c(avg_return, prod(ind_port_monthly[, i] + 1) ** (1 / nrow) - 1) } qrint(avg_return)
avg_return <- c() for (i in 2:ncol(ind_port_monthly)) { 	avg_return <- c(avg_return, prod(ind_port_monthly[, i] + 1) ** (1 / nrow) - 1) } qrint(avg_return)
for (i in 2:ncol(ind_port_monthly)) { 	avg_return <- c(avg_return, prod(ind_port_monthly[, i] + 1) ** (1 / nrow(ind_prot_monthly) - 1)) } qrint(avg_return)
avg_return <- c() for (i in 2:ncol(ind_port_monthly)) { 	avg_return <- c(avg_return, prod(ind_port_monthly[, i] + 1) ** (1 / nrow(ind_port_monthly) - 1)) } qrint(avg_return)
for (i in 2:ncol(ind_port_monthly)) { 	avg_return <- c(avg_return, prod(ind_port_monthly[, i] + 1) ** (1 / nrow(ind_port_monthly) - 1)) } print(avg_return)
avg_return <- c() for (i in 2:ncol(ind_port_monthly)) { 	avg_return <- c(avg_return, prod(ind_port_monthly[, i] / 100 + 1) ** (1 / nrow(ind_port_monthly) - 1)) } print(avg_return)
print(avg_return * 12)
for (i in 2:ncol(ind_port_monthly)) { 	avg_return <- c(avg_return, prod(subset(ind_port_monthly, "Date" > 197212)[, i] / 100 + 1) ** (1 / nrow(ind_port_monthly) - 1)) } print(avg_return * 12)
avg_return <- c() for (i in 2:ncol(ind_port_monthly)) { 	avg_return <- c(avg_return, prod(subset(ind_port_monthly, "Date" > 197212)[, i] / 100 + 1) ** (1 / nrow(ind_port_monthly) - 1)) } print(avg_return * 12)
avg_return <- c() for (i in 2:ncol(ind_port_annual)) { 	avg_return <- c(avg_return, prod(subset(ind_port_annual, "Date" > 1972)[, i] / 100 + 1) ** (1 / nrow(ind_port_annual) - 1)) } print(avg_return * 12)
avg_return <- c() arithmatic_avg <- c() for (i in 2:ncol(ind_port_annual)) { 	arithmatic_avg <- c(arithmatic_avg, mean(ind_port_annual, "Date" > 1972)[, i]) 	avg_return <- c(avg_return, prod(subset(ind_port_annual, "Date" > 1972)[, i] / 100 + 1) ** (1 / nrow(ind_port_annual) - 1)) } print(avg_return * 12) print(arithmatic_avg)
for (i in 2:ncol(ind_port_annual)) { 	arithmatic_avg <- c(arithmatic_avg, mean(subset(ind_port_annual, "Date" > 1972)[, i])) 	avg_return <- c(avg_return, prod(subset(ind_port_annual, "Date" > 1972)[, i] / 100 + 1) ** (1 / nrow(ind_port_annual) - 1)) } print(avg_return * 12) print(arithmatic_avg)
avg_return <- c() arithmatic_avg <- c() for (i in 2:ncol(ind_port_annual)) { 	arithmatic_avg <- c(arithmatic_avg, mean(subset(ind_port_annual, "Date" > 1972)[, i])) 	avg_return <- c(avg_return, prod(subset(ind_port_annual, "Date" > 1972)[, i] / 100 + 1) ** (1 / nrow(ind_port_annual) - 1)) } print(avg_return) print(arithmatic_avg)
avg_return <- c() arithmatic_avg <- c() for (i in 2:ncol(ind_port_annual)) { 	arithmatic_avg <- c(arithmatic_avg, mean(subset(ind_port_annual, "Date" > 1972)[, i])) 	avg_return <- c(avg_return, prod(subset(ind_port_annual, "Date" > 1972)[, i] / 100 + 1) ** (1 / nrow(subset(ind_port_annual, "Date" > 1972)) - 1)) } print(avg_return) print(arithmatic_avg)
nrow(subset(ind_port_annual, "Date" > 1972))
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
avg_return <- c() arithmatic_avg <- c() for (i in 2:ncol(ind_port_annual)) { 	arithmatic_avg <- c(arithmatic_avg, mean(subset(ind_port_annual, "Date" > 1972)[, i])) 	avg_return <- c(avg_return, geoMean(subset(ind_port_annual, "Date" > 1972)[, i] / 100 + 1)) #** (1 / nrow(subset(ind_port_annual, "Date" > 1972)) - 1)) } print(avg_return) print(arithmatic_avg)
subset(ind_port_annual, "Date" > 1972)
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
subset(ind_port_annual, "Date" > 1972)
subset(ind_port_annual, Date > 1972)
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
subset(ind_port_annual, Date > 1972)[, i] / 100 + 1
nrow(subset(ind_port_annual, Date > 1972))
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
subset(ind_port_annual, Date > 1972)[, port_no]
subset(ind_port_annual, Date > 1972)[, port_no]/100
subset(ind_port_annual, Date > 1972)[, port_no]/100+1
asdf<-c(2,3,4)
prod(asdf)
rm(asdf, envir = as.environment(".GlobalEnv"))
prod(subset(ind_port_annual, Date > 1972)[, port_no]/100+1)
prod(subset(ind_port_annual, Date > 1972)[, port_no]/100+1)**(1/44)
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
?list
asdf<-list("as dd"=1)
asdf
source(file = "Multiple_OLS.R")
source(file = "Multiple_OLS.R")
source(file = "Multiple_OLS.R")
rm(list = ls()) source(file = "Multiple_OLS.R") ind_port_monthly <- read.csv(file = "12_industry_portfolios.CSV", skip = 11, nrow = 1094, header = TRUE) ind_port_annual <- read.csv(file = "12_industry_portfolios.CSV", skip = 2207, nrow = 90, header = TRUE) colnames(ind_port_monthly)[1] <- "Date" colnames(ind_port_annual)[1] <- "Date" nondurable_monthly <- subset(ind_port_monthly, Date > 197212 & Date<=201112)[, "NoDur"] nondurable_annual <- subsed(ind_port_monthly, Date > 1972 & Date<=2011)[, "NoDur"]
rm(list = ls()) source(file = "Multiple_OLS.R") ind_port_monthly <- read.csv(file = "12_industry_portfolios.CSV", skip = 11, nrow = 1094, header = TRUE) ind_port_annual <- read.csv(file = "12_industry_portfolios.CSV", skip = 2207, nrow = 90, header = TRUE) colnames(ind_port_monthly)[1] <- "Date" colnames(ind_port_annual)[1] <- "Date" nondurable_monthly <- subset(ind_port_monthly, Date > 197212 & Date<=201112)[, "NoDur"] nondurable_annual <- subset(ind_port_monthly, Date > 1972 & Date<=2011)[, "NoDur"]
rm(list = ls()) source(file = "Multiple_OLS.R") ind_port_monthly <- read.csv(file = "12_industry_portfolios.CSV", skip = 11, nrow = 1094, header = TRUE) ind_port_annual <- read.csv(file = "12_industry_portfolios.CSV", skip = 2207, nrow = 90, header = TRUE) colnames(ind_port_monthly)[1] <- "Date" colnames(ind_port_annual)[1] <- "Date" nondurable_monthly <- subset(ind_port_monthly, Date > 197212 & Date<=201112)[, "NoDur"] nondurable_annual <- subset(ind_port_annual, Date > 1972 & Date<=2011)[, "NoDur"]
library(xlsx)
library(readxl)
unloadNamespace("xlsx")
unloadNamespace("xlsxjars")
?read_excel
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
class(riskfree_annual)
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
NoDur_ex_monthly
class(NoDur_ex_monthly)
class(regressor_monthly)
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
class(regressor_monthly)
asdf<-c(1,2,3)
class(asdf)
rm(asdf, envir = as.environment(".GlobalEnv"))
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
dim(NoDur_ex_monthly)
length(NoDur_ex_monthly)
dim(regressor_monthly)
beta <- solve(t(regressor_monthly) %*% regressor_monthly) %*% t(regressor_monthly) %*% NoDur_ex_monthly
nreg <- ncol(regressor_monthly)
nobs <- nrow(NoDur_ex_monthly)
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
beta <- solve(t(regressor_monthly) %*% regressor_monthly) %*% t(regressor_monthly) %*% NoDur_ex_monthly
nreg <- ncol(regressor_monthly)
nobs <- nrow(NoDur_ex_monthly)
dep_hat <- regressor_monthly %*% beta
res <- regressor_monthly - dep_hat
res <- NoDur_ex_monthly - dep_hat
ESS <- sum((dep_hat - mean(NoDur_ex_monthly)) ** 2)
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
beta <- solve(t(regressor_monthly) %*% regressor_monthly) %*% t(regressor_monthly) %*% NoDur_ex_monthly
nreg <- ncol(regressor_monthly)
nobs <- length(NoDur_ex_monthly)
dep_hat <- regressor_monthly %*% beta
res <- NoDur_ex_monthly - dep_hat
ESS <- sum((dep_hat - mean(NoDur_ex_monthly)) ** 2)
RSS <- t(res) %*% res
TSS <- t(NoDur_ex_annual - mean(NoDur_ex_annual)) %*% (NoDur_ex_annual - mean(NoDur_ex_annual))
ESS+RSS-TSS
TSS-RSS-ESS
ESS <- t(dep_hat - mean(NoDur_ex_annual)) %*% (dep_hat - mean(NoDur_ex_annual))
ESS+RSS-TSS
Rsqr <- ESS / TSS
rsqr
Rsqr
1-RSS/TSS
ESS <- t(dep_hat - mean(dep)) %*% (dep_hat - mean(dep))
ESS <- t(dep_hat - mean(NoDur_ex_monthly)) %*% (dep_hat - mean(NoDur_ex_monthly))
RSS <- t(res) %*% res
TSS <- t(NoDur_ex_annual - mean(NoDur_ex_annual)) %*% (NoDur_ex_annual - mean(NoDur_ex_annual))
Rsqr <- ESS / TSS
Rsqr
1-RSS/TSS
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
install.packages("car", lib="C:/Users/HP/Documents/R/win-library/3.3")
?ncvTest
library(car)
?ncvTest
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
result
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
result
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
result
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
?index
asdf<-matrix(c(1,2,3,4),nrow=2)
which(asdf,4)
which(asdf==4)
asdf<-matrix(c(2:17),nrow=4)
which(asdf==4)
match(4,matirx)
match(4,asdf)
source("White_test.R")
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
t(result$residual) %*% result$residual
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rm(list = ls()) library(readxl) source(file = "Multiple_OLS.R") ind_port_monthly <- read.csv(file = "12_industry_portfolios.CSV", skip = 11, nrow = 1094, header = TRUE) ind_port_annual <- read.csv(file = "12_industry_portfolios.CSV", skip = 2207, nrow = 90, header = TRUE) colnames(ind_port_monthly)[1] <- "Date" colnames(ind_port_annual)[1] <- "Date" nondurable_monthly <- subset(ind_port_monthly, Date > 197212 & Date <= 201112)[, "NoDur"] nondurable_annual <- subset(ind_port_annual, Date > 1972 & Date <= 2011)[, "NoDur"] riskfree_monthly <- subset(read_excel("GW_predictor_data.xlsx", sheet = "Monthly"), yyyymm > 197212 & yyyymm<=201112)[, "Rfree"] riskfree_annual <- subset(read_excel("GW_predictor_data.xlsx", sheet = "Annual"), yyyy > 1972 & yyyy<=2011)[, "Rfree"] NoDur_ex_monthly <- nondurable_monthly - riskfree_monthly * 100 NoDur_ex_annual <- nondurable_annual - riskfree_annual * 100 regressor_monthly <- as.matrix(cbind(rep(1,length(NoDur_ex_monthly)),subset(read_excel("macro_Data.xlsx", sheet = "macrodata"), year > 1972)[, c("S&P 500", "M2", "PI", "IP: cons nondble", "IP: nondble matls", "PMI", "IP: fuels", "CPI-U: transp", "Fed Funds")], 	subset(read_excel("macro_Data.xlsx", sheet = "financialdata"), year > 1972)[, c("Food", "Rtail", "Beer", "Smoke", "SMB", "HML", "Mkt-RF")])) colnames(regressor_monthly)[1] <- "Constant" rownames(regressor_monthly) <- (1:dim(regressor_monthly)[1]) result <- ols.multi(NoDur_ex_monthly, regressor_monthly) print(result) plot(result$residual,type="1", col="blue")
?plot
rm(list = ls()) library(readxl) source(file = "Multiple_OLS.R") ind_port_monthly <- read.csv(file = "12_industry_portfolios.CSV", skip = 11, nrow = 1094, header = TRUE) ind_port_annual <- read.csv(file = "12_industry_portfolios.CSV", skip = 2207, nrow = 90, header = TRUE) colnames(ind_port_monthly)[1] <- "Date" colnames(ind_port_annual)[1] <- "Date" nondurable_monthly <- subset(ind_port_monthly, Date > 197212 & Date <= 201112)[, "NoDur"] nondurable_annual <- subset(ind_port_annual, Date > 1972 & Date <= 2011)[, "NoDur"] riskfree_monthly <- subset(read_excel("GW_predictor_data.xlsx", sheet = "Monthly"), yyyymm > 197212 & yyyymm<=201112)[, "Rfree"] riskfree_annual <- subset(read_excel("GW_predictor_data.xlsx", sheet = "Annual"), yyyy > 1972 & yyyy<=2011)[, "Rfree"] NoDur_ex_monthly <- nondurable_monthly - riskfree_monthly * 100 NoDur_ex_annual <- nondurable_annual - riskfree_annual * 100 regressor_monthly <- as.matrix(cbind(rep(1,length(NoDur_ex_monthly)),subset(read_excel("macro_Data.xlsx", sheet = "macrodata"), year > 1972)[, c("S&P 500", "M2", "PI", "IP: cons nondble", "IP: nondble matls", "PMI", "IP: fuels", "CPI-U: transp", "Fed Funds")], 	subset(read_excel("macro_Data.xlsx", sheet = "financialdata"), year > 1972)[, c("Food", "Rtail", "Beer", "Smoke", "SMB", "HML", "Mkt-RF")])) colnames(regressor_monthly)[1] <- "Constant" rownames(regressor_monthly) <- (1:dim(regressor_monthly)[1]) result <- ols.multi(NoDur_ex_monthly, regressor_monthly) print(result) plot(result$residual,type="l", col="blue")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
install.packages("lmtest", lib="C:/Users/HP/Documents/R/win-library/3.3")
library(lmtest)
?bptest
result$residual
y1<- regressor_monthly %*% result$beta+ result$residual
bptest(y1,regressor_monthly)
for (j in 1:nobs - 1) { 	rho <- 0 	for (i in j + 1:nobs) { 		rho <- rho + result$residual[i] * result$residual[i - j] / (t(result$residual) %*% result$residual) 	} 	Q_sta <- Q_sta + nobs * rho ** 2 }
sesult$residual[i]
result$residual[i]
sesult$residual[2]
result$residual[2]
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
result$residual[i] * result$residual[i - j] / (t(result$residual) %*% result$residual)
result$residual[2] * result$residual[2 - 1] / (t(result$residual) %*% result$residual)
q_sta
Q_sta
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
for (j in 1:nobs - 1) { 	rho <- 0 	for (i in (j + 1):nobs) { 		rho <- rho + result$residual[i] * result$residual[i - j] / (t(result$residual) %*% result$residual) 	} 	Q_sta <- Q_sta + nobs * rho ** 2 }
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
for (j in 1:(nobs - 1)) { 	rho <- 0 	for (i in (j + 1):nobs) { 		rho <- rho + result$residual[i] * result$residual[i - j] / (t(result$residual) %*% result$residual) 	} 	Q_sta <- Q_sta + nobs * rho ** 2 }
nobs
for (j in 1:(length(NoDur_ex_monthly) - 1)) { 	rho <- 0 	for (i in (j + 1):length(NoDur_ex_monthly)) { 		rho <- rho + result$residual[i] * result$residual[i - j] / (t(result$residual) %*% result$residual) 	} 	Q_sta <- Q_sta + nobs * rho ** 2 }
for (j in 1:(length(NoDur_ex_monthly) - 1)) { 	rho <- 0 	for (i in (j + 1):length(NoDur_ex_monthly)) { 		rho <- rho + result$residual[i] * result$residual[i - j] / (t(result$residual) %*% result$residual) 	} 	Q_sta <- Q_sta + length(NoDur_ex_monthly) * rho ** 2 }
q_sta
Q_sta
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
bptest
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
bptest
bptest <- ols.multi(result$residual, regressor_monthly)$R_squared * length(NoDur_ex_monthly)
bptest <- ols.multi(result$residual, regressor_monthly)$R_squared * length(NoDur_ex_monthly)
bptest
ols.multi(result$residual, regressor_monthly)$R_squared
ols.multi(result$residual, regressor_monthly)$F_statistic
ols.multi(result$residual, regressor_monthly)
bptest <- ols.multi(t(result$residual) %*% result$residual, regressor_monthly)$R_squared * length(NoDur_ex_monthly)
residual_square <- t(result$residual) %*% result$residual)
residual_square <- t(result$residual) %*% result$residual
bptest <- ols.multi(residual_square, regressor_monthly)$R_squared * length(NoDur_ex_monthly)
residual_squre
residual_square
bptest <- ols.multi(result$residual %*% t(result$residual), regressor_monthly)$R_squared * length(NoDur_ex_monthly)
result$residual %*% t(result$residual)
class(resultbptest <- ols.multi(result$residual**2, regressor_monthly)$R_squared * length(NoDur_ex_monthly))
bptest
ols.multi(result$residual**2, regressor_monthly)$R_squared
ols.multi(result$residual**2, regressor_monthly)
bptest <- ols.multi(result$residual**2, regressor_monthly)$R_squared * length(NoDur_ex_monthly)
bptest
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
bptest
qchisq(.95,length(NoDur_ex_monthly)-dim(regressor_montly),lower.tail = FALSE)
qchisq(.95,length(NoDur_ex_monthly)-dim(regressor_monthly),lower.tail = FALSE)
qchisq(.95,length(NoDur_ex_monthly)-dim(regressor_monthly))
?qchisq
qchisq(.95,length(NoDur_ex_monthly)-dim(regressor_monthly)+1)
qchisq(.95,dim(regressor_monthly)-1)
qchisq(.95,dim(regressor_monthly)-1,loer.tail=FALSE)
qchisq(.95,dim(regressor_monthly)-1,lower.tail=FALSE)
pchisq(bptest,dim(regressor_montly)-1)
pchisq(bptest,dim(regressor_monthly)-1)
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
regressor_white
dim(regressor_white)
whitetest_f <- ols.multi(result$residual ** 2, regressor_white)$F_statistic
regressor_monthly[,2]**2
regressor_monthly[,2:dim(regressor_monthly)[2]]**2
cbind(rep(1,length(NoDur_ex_monthly)),regressor_monthly[,2:dim(regressor_monthly)[2]]**2)
regressor_white <- cbind(regressor_monthly, regressor_monthly[, 2:dim(regressor_monthly)[2]] ** 2) for (i in 2:(dim(regressor_monthly)[2] - 1)) { 	for (j in (i + 1):dim(regressor_monthly)[2]) { 		regressor_white <- cbind(regressor_white, regressor_monthly[i] * regressor_monthly[j]) 	} }
regressor_white
regressor_monthly[3]*regressor_monthly[4]
regressor_monthly[3]
regressor_white <- cbind(regressor_monthly, regressor_monthly[, 2:dim(regressor_monthly)[2]] ** 2) for (i in 2:(dim(regressor_monthly)[2] - 1)) { 	for (j in (i + 1):dim(regressor_monthly)[2]) { 		regressor_white <- cbind(regressor_white, regressor_monthly[,i] * regressor_monthly[,j]) 	} }
whitetest_f <- ols.multi(result$residual ** 2, regressor_white)$F_statistic
regressor_white
whitetest_f <- ols.multi(result$residual ** 2, regressor_white)$F_statistic
t(regressor_white)
solve(t(regressor_white)%*%regressor_white)
asdf<- c(1,2,3,4,5)
asdf[asdf=min(asdf[2:5])]
asdf<- c(5,4,3,2,1)
asdf[asdf=min(asdf[2:5])]
rm(asdf, envir = as.environment(".GlobalEnv"))
pt(result$t_statistic,length(NoDur_ex_monthly)-dim(regressor_monthly)[2])
1-pt(result$t_statistic,length(NoDur_ex_monthly)-dim(regressor_monthly)[2])
result$t_statistic
1-pt(result$t_statistic,length(NoDur_ex_monthly)-dim(regressor_monthly)[2])
2 * pt(-abs(result$t_statistic),length(NoDur_ex_monthly)-dim(regressor_monthly)[2])
2 * pt(-abs(result$t_statistic),length(NoDur_ex_monthly)-dim(regressor_monthly)[2])ttest <- 2 * pt(-abs(result$t_statistic), length(NoDur_ex_monthly) - dim(regressor_monthly)[2]) > .05 	continue <- as.logical(sum(ttest))
ttest <- 2 * pt(-1 * abs(result$t_statistic), length(NoDur_ex_monthly) - dim(regressor_monthly)[2]) > .05 continue <- as.logical(sum(ttest))
continue
ttest
(2 * pt(-1 * abs(result$t_statistic), length(NoDur_ex_monthly) - dim(regressor_monthly)[, 2]))[2:dim(regressor_monthly),]
dim(regressor_monthly)[, 2]
(2 * pt(-1 * abs(result$t_statistic), length(NoDur_ex_monthly) - dim(regressor_monthly)[2]))[2:dim(regressor_monthly),]
2 * pt(-1 * abs(result$t_statistic), length(NoDur_ex_monthly) - dim(regressor_monthly)[2]))[2:dim(regressor_monthly),]
(2 * pt(-1 * abs(result$t_statistic), length(NoDur_ex_monthly) - dim(regressor_monthly)[2]))[2:dim(regressor_monthly),]
(2 * pt(-1 * abs(result$t_statistic), length(NoDur_ex_monthly) - dim(regressor_monthly)[2]))
(2 * pt(-1 * abs(result$t_statistic), length(NoDur_ex_monthly) - dim(regressor_monthly)[2]))[2:dim(regressor_monthly)]
continue <- as.logical(sum(ttest[2:dim(regressor_monthly)[2]]))
continue
asdf<-matrix(rep(1,16))
asdf
asdf<-matrix(rep(1,16),nrow=4)
asdf
asdf[,2]<-NULL
asdf[,2]<-rep(NULL,dim(asdf)[1])
asdf[945,561,948,645,489,615]
asdf<-[945,561,948,645,489,615]
asdf<-c(945,561,948,645,489,615)
asdf[min(asdf)]
asdf[asdf=min(asdf)]
asdf[asdf=min(asdf)]
asdf
min(asdf)
asdf[asdf=489]
asdf=489
asdf==489
asdf
asdf<-489
asdf=c(894,489,375,189,567)
asdf[asdf==min(asdf)]
p_t <- 2 * pt(-1 * abs(result$t_statistic), length(NoDur_ex_monthly) - dim(regressor_monthly)[2])
p_t
	p_t <- 2 * pt(-1 * abs(result$t_statistic), length(NoDur_ex_monthly) - dim(regressor_monthly)[2]) 	ttest <- p_t > sig 	continue <- as.logical(sum(ttest[2:dim(regressor_monthly)[2]])) 	which.max(p_t[2:dim(regressor_monthly)[1]])
sig <- 0.1
	p_t <- 2 * pt(-1 * abs(result$t_statistic), length(NoDur_ex_monthly) - dim(regressor_monthly)[2]) 	ttest <- p_t > sig 	continue <- as.logical(sum(ttest[2:dim(regressor_monthly)[2]])) 	which.max(p_t[2:dim(regressor_monthly)[1]])
p_t
library(readxl)
asdf=read_excel("population mid month(1).xls",skip = 10)
asdf=read_excel("population in mid month(1).xls",skip = 10)
adf.test(asdf[,"POPTHM"])
library(tseries)
adf.test(asdf[,"POPTHM"])
class(adf.test(asdf[,"POPTHM"]))
str(adf.test(asdf[,"POPTHM"]))
adf.test(asdf[,"POPTHM"])$p.value
(asdf[,"POPTHM"])
asdf=read_excel("population in mid month(1).xls",skip = 12)
asdf=read_excel("population in mid month(1).xls",skip = 12)
adf.test(asdf[,3])
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
regressor_monthly
asdf=matrix(1:16,nrow = 4)
asdf
asdf[,3]
asdf[,-3]
which.max(p_t)
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
ttest
p_t
result_t_statistic
result$t_statistic
output=cbind(NoDur_ex_monthly,regressor_monthly)
write.csv(output,"test.csv")
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
1:dim(regressor_white[2])
regressor_white[2]
regressor_white[1]
regressor_white
dim(regressor_white)
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
dim(regressor_white[2])
dim(regressor_white)[2]
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
ols.multi(result$residual ** 2, regressor_white)
source("F:/Programming/Projects/rproject4/rproject4/Final_project.R", echo = TRUE, encoding = "gb2312")
whitetest_f
source(file = "Multiple_OLS.R")
source(file = "Multiple_OLS.R")
current_monthly <- reg_backward(NoDur_ex_monthly, regressor_monthly)
current_monthly
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
current_monthly
resplot
resplot(current_monthly)
resplot <- function(olslistname) { 	return(plot(olslistname$residual, type = "l", col = "blue")) }
resplot(current_monthly)
resplot(current_monthly)
current_monthly_white <- whitetest(current_monthly, regressor_monthly)
current_monthly_white
length(NoDur_ex_annual)
length(NoDur_ex_monthly)
rtvs::debug_source("F:/Programming/Projects/rproject4/rproject4/Final_project.R")
current_monthly <- reg_backward(NoDur_ex_monthly, regressor_monthly) resplot(current_monthly) current_monthly_bp <- bptest(current_monthly, NoDur_ex_monthly, regressor_monthly) current_monthly_white <- whitetest(current_monthly, regressor_monthly) current_monthly_jb <- jbtest(current_monthly, NoDur_ex_monthly) write.csv(list(current_monthly, current_monthly_bp, current_monthly_white, current_monthly_jb), file = "Current Monthly.csv")
current_monthly <- reg_backward(NoDur_ex_monthly, regressor_monthly) resplot(current_monthly) current_monthly_bp <- bptest(current_monthly, NoDur_ex_monthly, regressor_monthly) current_monthly_white <- whitetest(current_monthly, regressor_monthly) current_monthly_jb <- jbtest(current_monthly, NoDur_ex_monthly)
current_annual <- reg_backward(NoDur_ex_annual, regressor_annual) resplot(current_annual) current_annual_bp <- bptest(current_annual, NoDur_ex_annual, regressor_annual) current_annual_white <- whitetest(current_annual, regressor_annual) current_annual_jb <- jbtest(current_annual, NoDur_ex_annual)
regressor_annual <- as.matrix(cbind(rep(1, length(NoDur_ex_monthly)), read_excel("annual")[, 2:13]))
regressor_annual <- as.matrix(cbind(rep(1, length(NoDur_ex_monthly)), read_excel("annual.xlsx")[, 2:13]))
regressor_annual <- as.matrix(cbind(rep(1, length(NoDur_ex_monthly)), read_excel("annual.xlsx")[, 2:14]))
regressor_annual <- as.matrix(cbind(rep(1, length(NoDur_ex_monthly)), read_excel("annual.xlsx")[, 2:14]))
